#!/usr/bin/env bash
# Run the assistant autocommit check before commit. Non-blocking: it will create an assistant branch and push if conditions met.
ROOT_DIR="$(cd "$(dirname "$0")/.." && pwd)"
NODE_BIN=$(command -v node || true)
if [ -z "$NODE_BIN" ]; then
  echo "node not found; skipping assistant autocommit hook"
  exit 0
fi

if git diff --staged --quiet; then
  # nothing staged
  exit 0
fi

node "$ROOT_DIR/tools/assistant_autocommit.js" "assistant: pre-commit auto-commit"

exit 0
